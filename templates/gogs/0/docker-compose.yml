version: '2'
services:
  gogs:
    image: gogs/gogs:0.11.19
    links:
      - mysql:db
    volumes:
      - gogs-data:/data/gogs
  db:
    image: mysql:5.5
    environment:
      MYSQL_ROOT_PASSWORD: ${mysql_password}
      MYSQL_USER: ${mysql_user}
      MYSQL_PASSWORD: ${mysql_password}
      MYSQL_DATABASE: ${mysql_db}
    volumes:
      - gogs-db:/var/lib/mysql
  lb:
    image: rancher/lb-service-haproxy:v0.6.4
    ports:
    - ${http_port}:${http_port}/tcp
    - ${ssh_port}:${ssh_port}/tcp
volumes:
  gogs-db:
    driver: ${volume_driver}
  gogs-data:
    driver: ${volume_driver}

